<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Profile</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

<div class="max-w-xl mx-auto mt-10 bg-white shadow-lg rounded-2xl overflow-hidden p-6">

    <h1 class="text-2xl font-bold mb-4 text-center text-green-700">My Profile</h1>

    <div id="profile-content" class="space-y-4 text-center">
        Loading...
    </div>

    <div class="text-center mt-6">
        <a href="index.html" class="px-4 py-2 bg-green-700 text-white rounded-lg hover:bg-green-800">
            Back to Dashboard
        </a>
    </div>
</div>

<script type="module">
import { getAuth, onAuthStateChanged } 
    from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

import { getFirestore, doc, getDoc } 
    from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

import { app } from "./firebase-config.js";

const auth = getAuth(app);
const db = getFirestore(app);

onAuthStateChanged(auth, async (user) => {
    if (!user) {
        window.location.href = "login.html";
        return;
    }

    const ref = doc(db, "users", user.uid);
    const snap = await getDoc(ref);

    const data = snap.data();
    
    document.getElementById("profile-content").innerHTML = `
        <img src="${data.photo || 'default.png'}" 
            class="w-32 h-32 rounded-full mx-auto border-4 border-green-600" />

        <h2 class="text-xl font-bold">${data.name || "Unnamed"}</h2>

        <p class="text-gray-600">${user.email}</p>

        <p class="mt-1 inline-block px-3 py-1 rounded-md text-white 
            ${data.role === 'Admin' ? 'bg-red-600' : 'bg-blue-600'}">
            ${data.role || "Staff"}
        </p>

        <p class="text-gray-700 mt-2"><strong>Division:</strong> ${data.division || "Not assigned"}</p>
    `;
});
</script>

</body>
</html>
